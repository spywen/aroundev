"use strict";angular.module("aroundev",["ngAnimate","aroundev.translate","aroundev.menu","aroundev.index","aroundev.user.login","aroundev.service.security","ngRoute"]).config(["$translateProvider","$locationProvider","$routeProvider",function(e,n,r){r.otherwise({redirectTo:"/"}),n.html5Mode(!0),e.useStaticFilesLoader({prefix:"/app/js/modules/languages/json/",suffix:".json"}),e.useCookieStorage(),e.preferredLanguage("en")}]).value("user",{value:""}).run(["authService","securityService","$location","$rootScope",function(e,n,r,o){e.getProfil().then(function(e){o.$emit("user:logged",e),n.hasRole("AUTHENTICATED")||r.path("/login")},function(){})}]),angular.module("aroundev.service.auth",["pascalprecht.translate","restangular"]).config(["RestangularProvider",function(){}]).service("authService",["$translate","$http","$location","Restangular","$q","user",function(e,n,r,o,t,a){this.login=function(e,n){return t(function(r,t){var a={login:e,password:n},i=$.param(a);o.one("login").customPOST(i,void 0,void 0,{"Content-Type":"application/x-www-form-urlencoded"}).then(function(){r(!0)},function(){t(!1)})})},this.logout=function(){return t(function(n,r){o.one("logout").get().then(function(){window.location.reload(),n(result)},function(){toastr.error(e.instant("LOGIN_LOG_OUT_FAILED")),r(!1)})})},this.getProfil=function(){return t(function(e,n){o.one("api/user/currentProfil").get().then(function(n){a.value={username:n.login,roles:n.roles},e(n)},function(){n(!1)})})}}]),angular.module("aroundev.service.security",[]).service("securityService",["user",function(e){this.hasRole=function(n){return!!_.find(e.value.roles,{name:n})}}]),angular.module("aroundev.index",["ngRoute"]).config(["$routeProvider",function(e){e.when("/",{templateUrl:"/app/js/modules/index/view/index.html",controller:"indexCtrl"})}]).controller("indexCtrl",["$scope",function(e){e.pageClass="indexPageClass"}]),angular.module("aroundev.translate",["aroundev.service.auth","pascalprecht.translate","ngCookies"]).controller("translateCtrl",["$scope","$translate","$cookies",function(e,n,r){e.en=!1,e.fr=!1;var o=r.NG_TRANSLATE_LANG_KEY;'"en"'===o?e.en=!0:'"fr"'===o?e.fr=!0:e.en=!0,e.changeLanguage=function(r){n.use(r),e.en=!1,e.fr=!1,"en"===r?e.en=!0:"fr"===r?e.fr=!0:e.en=!0}}]),angular.module("aroundev.menu",["aroundev.service.auth"]).controller("menuCtrl",["$scope","authService","$rootScope","$location",function(e,n,r,o){e.logged=!1,r.$on("user:logged",function(n,r){e.logged=!0,e.username=r.login}),e.logOut=function(){n.logout()},e.isActive=function(e){return new RegExp(e).test(o.path())}}]).directive("menu",function(){return{scope:!0,restrict:"E",controller:"menuCtrl",templateUrl:"/app/js/modules/menu/view/menu.html"}}),angular.module("aroundev.user.login",["aroundev.service.auth","aroundev.service.security","pascalprecht.translate","ngAnimate","ngRoute"]).config(["$routeProvider",function(e){e.when("/login",{templateUrl:"/app/js/modules/user/view/login.html",controller:"loginCtrl"})}]).constant("localConfig",{connexionLatence:1e3}).run(["authService","securityService","$location",function(e,n,r){e.getProfil().then(function(){n.hasRole("AUTHENTICATED")&&r.path("/")},function(){})}]).controller("loginCtrl",["$translate","$scope","authService","$interval","$location","$rootScope","localConfig",function(e,n,r,o,t,a,i){n.chrono,n.pageClass="loginPageClass",n.logIn=function(){n.progressBarLogin=!0,n.progressBarValue=20,n.chrono=o(function(){r.login(n.login,n.password).then(function(){n.progressBarValue=60,r.getProfil().then(function(r){n.progressBarValue=100,n.progressBarType="progress-bar-success",n.chrono=o(function(){toastr.success(e.instant("LOGIN_LOG_IN_SUCCESS")),a.$emit("user:logged",r),t.path("/"),n.resetProgressBar()},i.connexionLatence,1)},function(){toastr.error(e.instant("COMMON_ERROR")),n.progressBarType="progress-bar-danger"})},function(){toastr.error(e.instant("LOGIN_LOG_IN_FAILED")),n.progressBarValue=100,n.progressBarType="progress-bar-danger",n.chrono=o(function(){return n.resetProgressBar()},4e3,1)})},i.connexionLatence,1)},n.resetProgressBar=function(){n.progressBarLogin=!1,n.progressBarValue=0,n.progressBarType=""},n.loginCtrlFieldsUpdated=function(){o.cancel(n.chrono),n.resetProgressBar()}}]);