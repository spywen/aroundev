angular.module("aroundev",["ngAnimate","ui.bootstrap","aroundev.translate","aroundev.menu","aroundev.index","aroundev.user.login","aroundev.service.security"]).config(["$translateProvider","$locationProvider",function(e,n){n.html5Mode(!0)}]).value("user",{value:""}).value("configs",{defaultLanguage:'"en"',translateAllowed:!1}).run(["authService","securityService","$location","$rootScope",function(e,n,o,r){e.getProfil().then(function(e){r.$broadcast("user:logged",e),n.hasRole("AUTHENTICATED")||o.path("/login")},function(){})}]),angular.module("aroundev.service.auth",["pascalprecht.translate","restangular"]).config(["RestangularProvider",function(){}]).service("authService",["$translate","$http","$location","Restangular","$q","user","toastr",function(e,n,o,r,t,a,s){this.login=function(e,n){return t(function(o,t){r.one("login").customPOST("login="+e+"&password="+n,void 0,void 0,{"Content-Type":"application/x-www-form-urlencoded"}).then(function(){o(!0)},function(){t(!1)})})},this.logout=function(){return t(function(n,o){r.one("logout").get().then(function(){window.location.reload(),n(result)},function(){s.error(e.instant("LOGIN_LOG_OUT_FAILED")),o(!1)})})},this.getProfil=function(){return t(function(e,n){r.one("api/user/currentProfil").get().then(function(n){a.value={username:n.login,roles:n.roles},e(n)},function(){n(!1)})})}}]),angular.module("aroundev.service.security",[]).service("securityService",["user",function(e){this.hasRole=function(n){return!!_.find(e.value.roles,{name:n})}}]),angular.module("aroundev.index",["ngRoute"]).config(["$routeProvider",function(e){e.when("/",{templateUrl:"/app/js/modules/index/view/index.html",controller:"indexCtrl"})}]).controller("indexCtrl",["$scope",function(e){e.pageClass="indexPageClass"}]),angular.module("aroundev.translate",["aroundev.service.auth","pascalprecht.translate","ngCookies"]).config(["$translateProvider",function(e){e.useStaticFilesLoader({prefix:"/app/js/modules/languages/json/",suffix:".json"}),e.useCookieStorage(),e.preferredLanguage("en")}]).controller("translateCtrl",["$scope","$translate","$cookies","configs",function(e,n,o,r){e.translateAllowed=r.translateAllowed,r.translateAllowed||(o.NG_TRANSLATE_LANG_KEY=r.defaultLanguage),e.en=!1,e.fr=!1;var t=o.NG_TRANSLATE_LANG_KEY;'"en"'===t?e.en=!0:'"fr"'===t?e.fr=!0:e.en=!0,e.changeLanguage=function(o){n.use(o),e.en=!1,e.fr=!1,"en"===o?e.en=!0:"fr"===o?e.fr=!0:e.en=!0}}]),angular.module("aroundev.menu",["aroundev.service.auth"]).controller("menuCtrl",["$scope","authService","$rootScope","$location",function(e,n,o,r){e.logged=!1,o.$on("user:logged",function(n,o){e.logged=!0,e.username=o.login}),e.logOut=function(){n.logout()},e.isActive=function(e){return new RegExp(e).test(r.path())}}]).directive("menu",function(){return{scope:!0,restrict:"E",controller:"menuCtrl",templateUrl:"/app/js/modules/menu/view/menu.html"}}),angular.module("aroundev.user.login",["aroundev.service.auth","pascalprecht.translate","ngRoute","toastr"]).config(["$routeProvider",function(e){e.when("/login",{templateUrl:"/app/js/modules/user/view/login.html",controller:"loginCtrl",resolve:{searchResults:["$location","authService","securityService",function(e,n,o){n.getProfil().then(function(){o.hasRole("AUTHENTICATED")&&e.path("/")},function(){})}]}})}]).constant("localConfig",{connexionLatence:1e3}).controller("loginCtrl",["$translate","$scope","authService","$interval","$location","$rootScope","localConfig","toastr",function(e,n,o,r,t,a,s,u){n.chrono=void 0,n.pageClass="loginPageClass",n.logIn=function(){n.progressBarLogin=!0,n.progressBarValue=20,n.chrono=r(function(){o.login(n.login,n.password).then(function(){n.progressBarValue=60,o.getProfil().then(function(o){n.progressBarValue=100,n.progressBarType="progress-bar-success",n.chrono=r(function(){u.success(e.instant("LOGIN_LOG_IN_SUCCESS")),a.$emit("user:logged",o),t.path("/"),n.resetProgressBar()},s.connexionLatence,1)},function(){u.error(e.instant("COMMON_ERROR")),n.progressBarType="progress-bar-danger"})},function(){u.error(e.instant("LOGIN_LOG_IN_FAILED")),n.progressBarValue=100,n.progressBarType="progress-bar-danger",n.chrono=r(function(){return n.resetProgressBar()},4e3,1)})},s.connexionLatence,1)},n.resetProgressBar=function(){n.progressBarLogin=!1,n.progressBarValue=0,n.progressBarType=""},n.loginCtrlFieldsUpdated=function(){r.cancel(n.chrono),n.resetProgressBar()}}]);